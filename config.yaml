default_storage:
  path: ${DB_PATH:fpl_data.db}
  type: sqlite
export:
  csv_dir: exports
  db_path: ${DB_PATH:fpl_data.db}
  schedule_hour: 0
global:
  log_backup_count: 7
  log_level: INFO
  log_rotation: midnight
  timezone: UTC
metrics:
  enabled: true
  port: 8000
ml:
  enabled: true
  recalculate_interval_hours: 6
network:
  cache_dir: ./cache
  cache_ttl_default: 300
  proxies: []
  session_pool_size: 10
  user_agents:
  - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
  - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15
notifications:
  telegram:
    chat_id: ${TELEGRAM_CHAT_ID:YOUR_CHAT_ID}
    enabled: false
    token: ${TELEGRAM_BOT_TOKEN:YOUR_TOKEN}
rate_limiter:
  backoff_factor: 2.0
  base_delay: 0.5
  error_threshold: 0.1
  max_delay: 10.0
  min_delay: 0.2
  success_window: 50
sources:
- enabled: true
  fetcher:
    headers:
      Accept: application/json
    method: GET
    url: https://fantasy.premierleague.com/api/bootstrap-static/
  name: fpl_bootstrap
  parser:
    type: json
  schedule: 0 */12 * * *
  storage:
  - table: bootstrap
    type: sqlite
  type: fpl
- enabled: true
  fetcher:
    headers:
      Accept: application/json
    method: GET
    pagination:
      max_pages: 5
      param: page_standings
      start: 1
      type: page
    params:
      league_id:
      - 314
      - 313
      - 417
    url: https://fantasy.premierleague.com/api/leagues-classic/{league_id}/standings/
  name: fpl_leagues
  parser:
    extract: $.standings.results[*]
    type: json
  schedule: '*/30 * * * *'
  storage:
  - table: league_standings
    type: sqlite
    unique_columns:
    - league_id
    - manager_id
  transformer:
  - mapping:
      entry: manager_id
      event_total: event_points
      total: total_points
    operation: rename
  type: fpl
- enabled: true
  fetcher:
    headers:
      Accept: application/json
    method: GET
    pagination:
      max_pages: 5
      param: page_standings
      start: 1
      type: page
    params:
      league_id:
      - 1125782
    url: https://fantasy.premierleague.com/api/leagues-classic/{league_id}/standings/
  name: fpl_league_les_mutants_1125782
  parser:
    extract: $.standings.results[*]
    type: json
  schedule: '*/5 * * * *'
  storage:
  - league_id: 1125782
    table: league_standings
    type: sqlite
    unique_columns:
    - league_id
    - manager_id
  transformer:
  - mapping:
      entry: manager_id
      event_total: event_points
      total: total_points
    operation: rename
  type: fpl
- enabled: true
  fetcher:
    headers:
      Accept: application/json
    method: GET
    url: https://fantasy.premierleague.com/api/entry/{manager_id}/history/
  name: fpl_manager_history
  parser:
    extract: $.current[*]
    type: json
  schedule: 0 */6 * * *
  storage:
  - table: manager_history
    type: sqlite
  type: fpl
- enabled: true
  fetcher:
    url: http://api.clubelo.com/
  name: elo_epl
  schedule: 0 6 * * *
  storage:
  - mode: overwrite
    table: raw_team_elo
    type: sqlite
  type: elo
- enabled: true
  name: understat_epl
  params:
    league: EPL
    season: '2024'
  schedule: 0 7 * * *
  storage:
  - mode: overwrite
    table: raw_understat_teams
    type: sqlite
  type: understat
- enabled: false
  name: fci_player_stats
  params:
    csv_path: player_gameweek_stats.csv
  schedule: 0 8 * * *
  storage:
  - mode: overwrite
    table: raw_fci_stats
    type: sqlite
  type: fci
- enabled: true
  name: calendar_breaks
  schedule: 0 0 * * 1
  storage:
  - mode: overwrite
    table: raw_calendar
    type: sqlite
  type: calendar
- enabled: false
  fetcher:
    method: GET
    url: https://jsonplaceholder.typicode.com/posts/1
  name: test_source
  parser:
    type: json
  schedule: '*/5 * * * *'
  storage:
  - table: test_data
    type: sqlite
  type: fpl
